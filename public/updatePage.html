<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href=",../css/style.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
        integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" href="css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Your Password</title>
</head>

<body>
    <div class="container mt-5">
        <h1>Reset Your Password</h1>

        <div class="row">
            <div class="col-sm-8">
                <div class="card">
                    <div class="card-body">

                        <!-- Makes POST request to /login route -->
                        <form action="/resetpassword" method="POST">
                            <div class="form-group">
                                <label for="email">Enter your registered email</label>
                                <input type="email" class="form-control" name="username" required>
                            </div>
                            <div class="form-group">
                                <label for="secretcode">Enter Secret Code</label>
                                <input type="number" class="form-control" name="secretcode" min="10000" max="99999"
                                  title="Type a 4 digit number" placeholder="Enter a 5 digit number" required>
                              </div>
                              <p id="passwordMismatch" style="color: red; display: none;">**Secret Code Mismatched**</p>
                            <div class="form-group">
                                <label for="newpass">New Password</label>
                                <input type="password" class="form-control" name="newpass"
                                    pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
                                    title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
                                    required>
                            </div>
                            
                            <button type="submit" class="btn btn-dark">Reset</button>
                        </form>

                    </div>
                </div>
            </div>

    <script>
        function displayPasswordMismatch() {
            document.getElementById("passwordMismatch").style.display = "block";
        }

        // Check if password mismatch response received from backend
        const urlParams = new URLSearchParams(window.location.search);
        const codeMismatch = urlParams.get('codeMismatch');
        if (codeMismatch === 'true') {
            displayPasswordMismatch();
        }
    </script>

</body>

</html>